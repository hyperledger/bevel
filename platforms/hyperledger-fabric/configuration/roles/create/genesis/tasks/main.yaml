##############################################################################################
#  Copyright Accenture. All Rights Reserved.
#
#  SPDX-License-Identifier: Apache-2.0
##############################################################################################

############################################################################################
# Fetch peers cetificates
- name: Fetch peers cetificates
  include_tasks: get_certificates.yaml
  vars:
    charts_dir: "{{ organization.gitops.chart_source }}"
    org_name: "{{ organization.name | lower }}"
    peers: "{{ organization.services.peers }}"
  loop: "{{ network['organizations'] }}"
  loop_control:
    loop_var: organization
  when: 
    - organization.services.peers is defined and organization.services.peers | length > 0
    - organization.name != org.name

# Get channel_name
- name: Get channel_name
  include_tasks: get_channel_creator.yaml
  vars:
    channel_orgs: "{{ channel.orderers}}"
  loop: "{{ network['channels'] }}"
  loop_control:
    loop_var: channel
